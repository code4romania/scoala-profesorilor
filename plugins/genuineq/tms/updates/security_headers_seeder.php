<?php namespace Genuineq\Tms\Updates;

use Db;
use October\Rain\Database\Updates\Migration;

class SecurityHeadersSeeder extends Migration
{
    /**
     * Populates system tables and dependency plugins tables.
     */
    public function up()
    {
        /** Populate system_settings table with the security headers. */
        Db::table('system_settings')->insert(['id' => 10, 'item' => 'zaxbux_securityheaders_hsts_settings', 'value' => '{"enabled":"1","max_age":"63072000","subdomains":"1","preload":"1"}']);
        Db::table('system_settings')->insert(['id' => 11, 'item' => 'zaxbux_securityheaders_csp_settings', 'value' => '{"enabled":"1","report_only":"0","log_violations":"0","upgrade_insecure_requests":"1","block_all_mixed_content":"0","default_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"child_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"connect_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"font_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-brands-400.woff2","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-brands-400.woff","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-brands-400.ttf","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-regular-400.woff2","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-regular-400.woff","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-regular-400.ttf","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-solid-900.woff2","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-solid-900.woff","_group":"host"},{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/webfonts\/fa-solid-900.ttf","_group":"host"},{"value":"https:\/\/maxcdn.bootstrapcdn.com\/font-awesome\/4.7.0\/fonts\/fontawesome-webfont.woff2","_group":"host"},{"value":"https:\/\/maxcdn.bootstrapcdn.com\/font-awesome\/4.7.0\/fonts\/fontawesome-webfont.woff","_group":"host"},{"value":"https:\/\/maxcdn.bootstrapcdn.com\/font-awesome\/4.7.0\/fonts\/fontawesome-webfont.ttf","_group":"host"}]},"frame_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[{"value":"https:\/\/www.google.com\/","_group":"host"}]},"img_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[{"value":"data:","_group":"host"}]},"manifest_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"media_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"object_src":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"script_src":{"none":"0","self":"1","unsafe_inline":"1","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[{"value":"https:\/\/cdn.datatables.net\/v\/bs4\/jszip-2.5.0\/dt-1.10.21\/b-1.6.2\/b-colvis-1.6.2\/b-flash-1.6.2\/b-html5-1.6.2\/b-print-1.6.2\/kt-2.5.2\/r-2.2.5\/rr-1.2.7\/sc-2.0.2\/sp-1.1.1\/sl-1.3.1\/datatables.min.js","_group":"host"},{"value":"https:\/\/www.google.com\/recaptcha\/api.js","_group":"host"},{"value":"https:\/\/www.gstatic.com\/recaptcha\/releases\/pRiAUlKgZOMcFLsfzZTeGtOA\/recaptcha__ro.js","_group":"host"}]},"style_src":{"none":"0","self":"1","unsafe_inline":"1","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[{"value":"https:\/\/use.fontawesome.com\/releases\/v5.6.3\/css\/all.css","_group":"host"},{"value":"https:\/\/maxcdn.bootstrapcdn.com\/font-awesome\/4.7.0\/css\/font-awesome.min.css","_group":"host"}]},"form_action":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"frame_ancestors":{"none":"0","self":"1","_user_sources":[]},"base_uri":{"none":"0","self":"1","unsafe_inline":"0","unsafe_eval":"0","strict_dynamic":"0","unsafe_hashes":"0","report_sample":"0","nonce_source":"0","_user_sources":[]},"sandbox":["allow-forms","allow-modals","allow-popups","allow-same-origin","allow-scripts"],"plugin_types":[]}']);
        Db::table('system_settings')->insert(['id' => 12, 'item' => 'zaxbux_securityheaders_other_header_settings', 'value' => '{"referrer_policy":"strict-origin-when-cross-origin","frame_options":"deny","content_type_options":"1","xss_protection":"","report_to":"0"}']);
    }

    public function down()
    {
        /** Delete the security headers from the system settings. */
        Db::table('system_settings')->where(['id' => 10])->delete();
        Db::table('system_settings')->where(['id' => 11])->delete();
        Db::table('system_settings')->where(['id' => 12])->delete();
    }
}
